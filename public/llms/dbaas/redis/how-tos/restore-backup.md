Original link: https://docs.liara.ir/dbaas/redis/how-tos/restore-backup/

# بازیابی فایل پشتیبان در دیتابیس

> در حال حاضر، به صورت رسمی، از نسخه redis 7 به بعد، ابزاری برای بازیابی
> فایل پشتیبان، وجود ندارد. اما ابزارهای زیادی توسط جامعه فعال redis توسعه داده شده است
> که می‌توان از آن‌ها استفاده کرد.

## redis < 7

برای بازیابی فایل پشتیبان با استفاده از
[rdbtools](https://github.com/sripathikrishnan/redis-rdb-tools) و [`redis-cli`](https://docs.liara.ir/redis/latest/operate/oss_and_stack/install/install-redis/)، می‌توانید مشابه دستور زیر، عمل کنید:    

```bash
rdb -c protocol /path/to/backup-file.dump | redis-cli -p REDIS_PORT -h REDIS_HOST -a REDIS_PASSWORD --pipe
```

## redis >= 7

برای بازیابی فایل پشتیبان در redis 7 به بعد، پیشنهاد برنامه‌نویسان redis، 
استفاده از ابزار غیر رسمی [redis-rdb-cli](https://github.com/leonchen83/redis-rdb-cli) است. 
شما می‌توانید برای استفاده از این ابزار و سهولت در استفاده از آن، از اسکریپت‌های 
از پیش نوشته شده لیارا، استفاده کنید. 
برای این کار تنها کافیست تا مراحل زیر را قدم به قدم، جلو بروید:  

## Linux

۱. دانلود ریپازیتوری   
با اجرای دستور زیر، ریپازیتوری شامل دستورات را در لوکال، دانلود کنید:

```bash
git clone https://github.com/liara-cloud/redis-rdb-cli.git
```

اگر که امکان دانلود ریپازیتوری را ندارید؛ کافیست تا در مسیر دلخواه، 
یک دایرکتوری با نام دلخواه برای خود ایجاد کنید، درون آن یک فایل به اسم `setup.sh`
ایجاد کنید و قطعه کد موجود در [این آدرس](https://github.com/liara-cloud/redis-rdb-cli/blob/master/setup.sh) را درون آن، قرار دهید.

۲. دانلود فایل پشتیبان
طبق [مستندات تهیه فایل پشتیبان](https://docs.liara.ir/dbaas/redis/how-tos/create-backup/) از دیتابیس خود فایل پشتیبان تهیه کنید. اگر که فایل پشتیبان را 
از قبل دانلود کرده‌اید نیازی به انجام این مرحله نیست.

۳. استخراج و بررسی فایل پشتیبان
اگر که فایل پشتیبان‌تان درون یک فایل zip قرار دارد باید آن را استخراج کنید. در ادامه، بایستی فایل پشتیبان را در دایرکتوری‌ای قرار دهید 
که فایل `setup.sh` در آن، قرار دارد. حتماً دقت داشته باشید که پسوند فایل پشتیبان، 
`dump.` یا `rdb.` باشد.

۴. اعطای دسترسی به فایل `setup.sh`
برای جلوگیری از خطا خوردن فرایند بازیابی فایل پشتیبان، دستور زیر را در مسیر اصلی جایی که فایل `setup.sh` قرار دارد اجرا کنید تا دسترسی‌های لازم به برنامه، داده شود:

```bash
chmod +x setup.sh
```

۵. بازیابی دیتابیس با فایل پشتیبان
در نهایت، دستور زیر را اجرا کنید تا اسکریپت، برای شما اجرا شود. در ادامه، برنامه از شما می‌خواهد که 
URI مربوط به دیتابیس Redis را وارد کنید که می‌توانید طبق [مستندات راه‌های اتصال](https://docs.liara.ir/dbaas/details/connection-links)، از URI **شبکه عمومی**، استفاده کنید:

```bash
sh setup.sh
```

## Windows

۱. دانلود ریپازیتوری   
با اجرای دستور زیر، ریپازیتوری شامل دستورات را در لوکال، دانلود کنید:

```bash
git clone https://github.com/liara-cloud/redis-rdb-cli.git
```

اگر که امکان دانلود ریپازیتوری را ندارید؛ کافیست تا در مسیر دلخواه، 
یک دایرکتوری با نام دلخواه برای خود ایجاد کنید، درون آن یک فایل به اسم `setup.ps1`
ایجاد کنید و قطعه کد موجود در [این آدرس](https://github.com/liara-cloud/redis-rdb-cli/blob/master/setup.ps1) را درون آن، قرار دهید.

۲. دانلود فایل پشتیبان
طبق [مستندات تهیه فایل پشتیبان](https://docs.liara.ir/dbaas/redis/how-tos/create-backup/) از دیتابیس خود فایل پشتیبان تهیه کنید. اگر که فایل پشتیبان را 
از قبل دانلود کرده‌اید نیازی به انجام این مرحله نیست.

۳. استخراج و بررسی فایل پشتیبان
اگر که فایل پشتیبان‌تان درون یک فایل zip قرار دارد باید آن را استخراج کنید. در ادامه، بایستی فایل پشتیبان را در دایرکتوری‌ای قرار دهید 
که فایل `setup.ps1` در آن، قرار دارد. حتماً دقت داشته باشید که پسوند فایل پشتیبان، 
`dump.` یا `rdb.` باشد.

۴. اعطای دسترسی به فایل `setup.ps1`
برای جلوگیری از خطا خوردن فرایند بازیابی فایل پشتیبان، دستور زیر را در مسیر اصلی جایی که فایل `setup.ps1` قرار دارد، در PowerShell، اجرا کنید تا دسترسی‌های لازم به برنامه، داده شود:

```bash
Set-ExecutionPolicy -Scope Process -ExecutionPolicy Bypass
```

۵. بازیابی دیتابیس با فایل پشتیبان
در نهایت، دستور زیر را اجرا کنید تا اسکریپت، برای شما اجرا شود. در ادامه، برنامه از شما می‌خواهد که 
URI مربوط به دیتابیس Redis را وارد کنید که می‌توانید طبق [مستندات راه‌های اتصال](https://docs.liara.ir/dbaas/details/connection-links)، از URI **شبکه عمومی**، استفاده کنید:

```bash
.\\setup.ps1
```

## all links

[All links of docs](https://docs.liara.ir/all-links-llms.txt)
